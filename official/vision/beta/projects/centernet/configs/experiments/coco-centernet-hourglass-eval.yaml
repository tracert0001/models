runtime:
  distribution_strategy: 'mirrored'
  mixed_precision_dtype: 'float16'
  loss_scale: 'dynamic'
  num_gpus: 1
task:
  model:
    num_classes: 90
    max_num_instances: 128
    input_size: [512, 512, 3] # null
    backbone:
      type: hourglass
      hourglass:
        model_id: 52
        num_hourglasses: 2
    head:
      heatmap_bias: -2.19
    detection_generator:
      max_detections: 100
      peak_error: 0.000001
      peak_extract_kernel_size: 3
      use_nms: false
      nms_pre_thresh: 0.1
      nms_thresh: 0.4
      class_offset: 1
  subtasks:
    detection:
      use_centers: true
      use_corners: false
      predict_3d: false
  losses:
    detection:
      detection_weight: 1.0
      corner_pull_weight: 0.1
      corner_push_weight: 0.1
      offset_weight: 1.0
    segmentation:
    use_gaussian_bump: true
    gaussian_rad: -1
    gaussian_iou: 0.7
  per_category_metrics: false
  weight_decay: 0.0005
  gradient_clip_norm: 0.0
  init_checkpoint: 'centernet_hg104_512x512_coco17_tpu-8/checkpoint'
  init_checkpoint_source: 'ODAPI'
  annotation_file: 'coco/instances_val2017.json'
  checkpoint_backbone_name: 'hourglass104_512'
  checkpoint_head_name: 'detection_2d'
  validation_data:
    input_path: 'coco/val*'
    drop_remainder: false
    dtype: 'float16'
    global_batch_size: 8
    is_training: false
trainer:
  train_steps: 10000 # 160 epochs at 64 batchsize -> 500500 * 64/16
  validation_steps: 625 # 5063 #625
  steps_per_loop: 10000
  validation_interval: 1
  summary_interval: 10000
  checkpoint_interval: 10000
  optimizer_config:
    learning_rate:
      type: stepwise
      stepwise:
        boundaries: [800000, 900000] # [400000, 450000]
        values: [0.00065, 0.000065, 0.0000065] #[0.0013, 0.00013, 0.000013]
    optimizer:
      type: sgd
      sgd:
        momentum: 0.949
    warmup:
      type: 'linear'
      linear:
        warmup_steps: 1000 #learning rate rises from 0 to 0.0013 over 1000 steps
